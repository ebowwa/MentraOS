# XIP Configuration Overlay for MX25R6435F 8MB NOR Flash  
# This file works with prj.conf to enable XIP functionality
# Usage: west build -- -DCONF_FILE="prj.conf;prj_xip_clean.conf"

# Core XIP Configuration
CONFIG_XIP=y

# Custom linker script for XIP support
CONFIG_HAVE_CUSTOM_LINKER_SCRIPT=y
CONFIG_CUSTOM_LINKER_SCRIPT="linker_arm_extxip.ld"

# External Flash Support via QSPI
CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_FLASH_PAGE_LAYOUT=y
CONFIG_NORDIC_QSPI_NOR=y
CONFIG_NORDIC_QSPI_NOR_FLASH_LAYOUT_PAGE_SIZE=4096
CONFIG_NORDIC_QSPI_NOR_XIP=y

# File System Support
CONFIG_FILE_SYSTEM=y
CONFIG_FILE_SYSTEM_LITTLEFS=y

# Shell support for XIP testing  
CONFIG_SHELL=y
CONFIG_SHELL_BACKEND_SERIAL=y
CONFIG_SHELL_PROMPT_UART="xip:~$ "

# Enable additional logging for XIP debugging
CONFIG_LOG=y
CONFIG_LOG_DEFAULT_LEVEL=3
CONFIG_FLASH_LOG_LEVEL_DBG=y

# Memory optimization for XIP
CONFIG_MAIN_STACK_SIZE=4096
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=4096

# Disable HLS12VGA driver for XIP testing to avoid undefined references
CONFIG_CUSTOM_HLS12VGA=n